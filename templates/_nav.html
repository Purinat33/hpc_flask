<header class="site site-header">
    <a class="brand" href="{{ url_for('playground') }}">
        <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Logo" />
    </a>

    {% set bp = request.blueprint or '' %}
    {% set cur_locale = (get_locale()|string) %}
    {% set is_en = cur_locale[:2] == 'en' %}
    {% set is_en = (locale_code()[:2] == 'en') %}

    <nav class="nav">
        <a class="{% if request.endpoint == 'playground' %}active{% endif %}" href="{{ url_for('playground') }}"
            aria-current="{% if request.endpoint == 'playground' %}page{% endif %}">
            {{ _("Home") }}
        </a>

        {% if current_user.is_authenticated %}
        {% if current_user.is_admin|default(false) %}
        <a class="{% if bp == 'admin' %}active{% endif %}" href="{{ url_for('admin.admin_form') }}"
            aria-current="{% if bp == 'admin' %}page{% endif %}">
            {{ _("Admin") }}
        </a>
        {% else %}
        <a class="{% if bp == 'user' %}active{% endif %}" href="{{ url_for('user.my_usage') }}"
            aria-current="{% if bp == 'user' %}page{% endif %}">
            {{ _("My Usage") }}
        </a>
        {% endif %}

        <span class="sp"></span>

        <form method="post" action="{{ url_for('auth.logout') }}" style="display:inline">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button class="navbtn" type="submit">{% trans user=current_user.username %}Logout ({{ user }}){% endtrans %}</button>
        </form>
        {% else %}
        <span class="sp"></span>
        <a class="{% if bp == 'auth' %}active{% endif %}" href="{{ url_for('auth.login') }}"
            aria-current="{% if bp == 'auth' %}page{% endif %}">
            {{ _("Login") }}
        </a>
        {% endif %}

        <!-- Language toggle -->
        <form method="post" action="{{ url_for('set_locale') }}" style="display:inline; margin-left:.5rem">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <input type="hidden" name="lang" value="{{ 'th' if is_en else 'en' }}">
            <button class="navbtn" type="submit">{{ 'ไทย' if is_en else 'EN' }}</button>
        </form>
    </nav>
</header>
